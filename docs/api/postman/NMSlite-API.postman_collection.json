{
	"info": {
		"_postman_id": "nmslite-api-collection-v1",
		"name": "NMS Lite API",
		"description": "Complete API collection for NMS Lite - Network Monitoring System.\n\n**Authentication:** All protected endpoints require a JWT Bearer token. Use the Login endpoint first to obtain a token.\n\n**Workflow:**\n1. Call Login to get JWT token (auto-saved)\n2. Create Credential Profile\n3. Create Discovery Profile with credential\n4. Run Discovery to find devices\n5. Manage discovered Monitors",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string",
			"description": "Base URL of the NMS Lite API server"
		},
		{
			"key": "token",
			"value": "",
			"type": "string",
			"description": "JWT token - auto-populated after login"
		},
		{
			"key": "admin_username",
			"value": "admin",
			"type": "string",
			"description": "Default admin username"
		},
		{
			"key": "admin_password",
			"value": "Admin@123",
			"type": "string",
			"description": "Default admin password"
		}
	],
	"item": [
		{
			"name": "System & Auth",
			"description": "Public endpoints for health checks, system info, and authentication",
			"auth": {
				"type": "noauth"
			},
			"item": [
				{
					"name": "Health Check (Liveness)",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/health",
						"description": "Liveness probe - checks if the service is running"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"pm.test('Response has status ok', function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql('ok');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"{{admin_username}}\",\n    \"password\": \"{{admin_password}}\"\n}"
						},
						"url": "{{base_url}}/api/v1/login",
						"description": "Authenticate and receive JWT token. Token is automatically saved to the environment variable."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.token) {",
									"        pm.collectionVariables.set('token', jsonData.token);",
									"        pm.environment.set('token', jsonData.token);",
									"        console.log('Token saved.');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Login (Invalid)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"wrong\",\n    \"password\": \"wrong\"\n}"
						},
						"url": "{{base_url}}/api/v1/login",
						"description": "Negative test for login"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 401', function () {",
									"    pm.response.to.have.status(401);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Credentials",
			"description": "Credential Profile management endpoints (protected)",
			"item": [
				{
					"name": "List All Credentials",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/credentials",
						"description": "List all credential profiles."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Create Credential (SSH)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"SSH Credentials\",\n    \"description\": \"SSH access for Linux servers\",\n    \"protocol\": \"ssh\",\n    \"payload\": {\n        \"username\": \"admin\",\n        \"password\": \"secure_password\"\n    }\n}"
						},
						"url": "{{base_url}}/api/v1/credentials"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.id) {",
									"        pm.collectionVariables.set('credential_id', jsonData.id);",
									"        pm.environment.set('credential_id', jsonData.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Credential by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/credentials/{{credential_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Update Credential",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Updated SSH Credentials\",\n    \"description\": \"Updated SSH access for servers\",\n    \"protocol\": \"ssh\",\n    \"payload\": {\n        \"username\": \"newadmin\",\n        \"password\": \"new_secure_password\"\n    }\n}"
						},
						"url": "{{base_url}}/api/v1/credentials/{{credential_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Delete Credential",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": "{{base_url}}/api/v1/credentials/{{credential_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 204', function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Discoveries",
			"description": "Discovery Profile management and execution endpoints (protected)",
			"item": [
				{
					"name": "List All Discoveries",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/discoveries"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Create Discovery (CIDR)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Network Scan - SSH\",\n    \"target_value\": \"192.168.1.0/24\",\n    \"port\": 22,\n    \"port_scan_timeout_ms\": 5000,\n    \"credential_profile_id\": \"{{credential_id}}\",\n    \"auto_provision\": true,\n    \"auto_run\": true\n}"
						},
						"url": "{{base_url}}/api/v1/discoveries"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.id) {",
									"        pm.collectionVariables.set('discovery_id', jsonData.id);",
									"        pm.environment.set('discovery_id', jsonData.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Discovery by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/discoveries/{{discovery_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Run Discovery",
					"request": {
						"method": "POST",
						"header": [],
						"url": "{{base_url}}/api/v1/discoveries/{{discovery_id}}/run"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 202', function () {",
									"    pm.response.to.have.status(202);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Discovery Feed (WebSocket)",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{ws_url}}/ws/discovery",
						"description": "Connect to this WebSocket endpoint to receive real-time discovery events (e.g. device found, scan complete). In Postman, switch to a WebSocket request tab and use this URL. Note: Requires 'token' query parameter or header if auth is enforced on upgrade (currently URL query param 'token' supported in many implementations, but here it relies on standard HTTP Upgrade which carries headers)."
					},
					"response": []
				},
				{
					"name": "Get Discovery Results",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/discoveries/{{discovery_id}}/results"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Delete Discovery",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": "{{base_url}}/api/v1/discoveries/{{discovery_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 204', function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Monitors",
			"description": "Monitor (Device) management endpoints (protected)",
			"item": [
				{
					"name": "Create Monitor (Manual)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"display_name\": \"web-prod-01\",\n    \"hostname\": \"web-prod-01.internal\",\n    \"ip_address\": \"192.168.10.20\",\n    \"plugin_id\": \"windows-winrm\",\n    \"credential_profile_id\": \"{{credential_id}}\",\n    \"discovery_profile_id\": \"{{discovery_id}}\",\n    \"polling_interval_seconds\": 60,\n    \"port\": 5985\n}"
						},
						"url": "{{base_url}}/api/v1/monitors"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 201', function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.id) {",
									"        pm.collectionVariables.set('monitor_id', jsonData.id);",
									"        pm.environment.set('monitor_id', jsonData.id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "List All Monitors",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/monitors"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Get Monitor by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/monitors/{{monitor_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Update Monitor",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"display_name\": \"Server-01 Updated\",\n    \"polling_interval_seconds\": 300\n}"
						},
						"url": "{{base_url}}/api/v1/monitors/{{monitor_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Delete Monitor",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": "{{base_url}}/api/v1/monitors/{{monitor_id}}"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 204', function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Metrics",
			"description": "Batch metrics query endpoints for polling data (CPU, disk, memory, etc.)",
			"item": [
				{
					"name": "Query Metrics - All Metrics",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\"],\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"limit\": 50\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query all metrics for a device within a time range."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"pm.test('Response has data object', function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.data).to.exist;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Query Metrics - CPU Only (prefix)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\"],\n    \"prefix\": \"system.cpu\",\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"limit\": 100\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query only CPU metrics using prefix filter. Matches metrics like system.cpu.usage, system.cpu.core.0, etc."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Query Metrics - Disk Only (prefix)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\"],\n    \"prefix\": \"system.disk\",\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"limit\": 100\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query only disk metrics using prefix filter."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Query Metrics - Memory Only (prefix)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\"],\n    \"prefix\": \"system.memory\",\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"limit\": 100\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query only memory metrics using prefix filter."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Query Metrics - Latest Values Only",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\"],\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"latest\": true\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query only the latest value for each metric (deduped by metric name). Useful for dashboards."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Query Metrics - Multiple Devices",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_ids\": [\"{{monitor_id}}\", \"00000000-0000-0000-0000-000000000000\"],\n    \"prefix\": \"system.cpu\",\n    \"start\": \"2025-12-01T00:00:00Z\",\n    \"end\": \"2025-12-31T23:59:59Z\",\n    \"latest\": true\n}"
						},
						"url": "{{base_url}}/api/v1/metrics/query",
						"description": "Query metrics for multiple devices at once. Results are grouped by device_id."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Protocols",
			"description": "Protocol information",
			"item": [
				{
					"name": "List All Protocols",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/protocols"
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		},
		{
			"name": "Devices",
			"description": "Device management endpoints (discovered devices awaiting provisioning)",
			"item": [
				{
					"name": "List All Devices",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/devices",
						"description": "List all discovered devices. Optionally filter by discovery_profile_id query parameter."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "List Devices by Discovery Profile",
					"request": {
						"method": "GET",
						"header": [],
						"url": "{{base_url}}/api/v1/devices?discovery_profile_id={{discovery_id}}",
						"description": "List discovered devices filtered by discovery profile ID."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Delete Device",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": "{{base_url}}/api/v1/devices/{{device_id}}",
						"description": "Delete a discovered device by ID."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 204', function () {",
									"    pm.response.to.have.status(204);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					]
				},
				{
					"name": "Provision Device",
					"request": {
						"method": "POST",
						"header": [],
						"url": "{{base_url}}/api/v1/devices/{{device_id}}/provision",
						"description": "Provision a discovered device, creating a monitor from it."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.monitor_id) {",
									"        pm.collectionVariables.set('monitor_id', jsonData.monitor_id);",
									"        pm.environment.set('monitor_id', jsonData.monitor_id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					]
				}
			]
		}
	]
}